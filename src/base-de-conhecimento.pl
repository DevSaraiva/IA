%grafo

aresta(palmeira/rua-do-rio,palmeira/rua-da-poca,3.4,6).
aresta(palmeira/rua-do-rio,palmeira/rua-do-monte,3.1,5).
aresta(palmeira/rua-do-monte,palmeira/rua-da-poca,2.4,4).
aresta(palmeira/rua-do-rio,real/rua-dos-paiois,8.5,12).
aresta(palmeira/rua-da-poca,maximinos/rua-do-caires,6.5,9).
aresta(palmeira/rua-do-monte,maximinos/rua-da-naia,7,10).
aresta(maximinos/rua-da-naia,maximinos/rua-de-caires,2.2,5).
aresta(maximinos/rua-da-naia,maximinos/rua-do-cruzeiro,0.65,2).
aresta(maximinos/rua-do-cruzeiro,maximinos/rua-de-caires,2,4).
aresta(maximinos/rua-do-cruzeiro,real/rua-do-tojal,1.8,4).
aresta(real/rua-do-tojal,real/rua-dos-paiois,0.4,2).
aresta(real/rua-do-tojal,real/rua-das-giestas,0.3,2).
aresta(real/rua-dos-paiois,real/rua-das-giestas,0.35,1).
aresta(sao-vitor/rua-do-taxa,real/rua-das-giestas,6.3,9).
aresta(sao-vitor/rua-do-taxa,sao-vitor/rua-da-fabrica,1.2,4).
aresta(sao-vitor/rua-da-fabrica,sao-vitor/rua-dom-pedro-v,0.8,2).
aresta(sao-vitor/rua-do-taxa,sao-vitor/rua-dom-pedro-v,1.6,3).
aresta(sao-vitor/rua-da-fabrica,nogueiro/rua-da-capela,3.1,6).
aresta(sao-vitor/rua-dom-pedro-v,gualtar/rua-do-fontelo,2.7,5).
aresta(sao-vitor/rua-do-taxa,lamacaes/rua-da-torre,3.9,8).
aresta(gualtar/rua-do-fontelo,gualtar/rua-do-fontao,2.3,5).
aresta(gualtar/rua-do-fontao,gualtar/green-distribution,2.9,6).
aresta(gualtar/green-distribution,gualtar/rua-breias,2.4,5).
aresta(gualtar/rua-breias,nogueiro/rua-do-major,5,9).
aresta(nogueiro/rua-do-major,nogueiro/rua-da-rasa,0.4,2).
aresta(nogueiro/rua-da-rasa,nogueiro/rua-da-capela,0.75,3).
aresta(nogueiro/rua-da-capela,nogueiro/rua-do-major,0.65,2).
aresta(gualtar/rua-do-fontao,lamacaes/rua-da-carreira,4.9,9).
aresta(lamacaes/rua-da-carreira,lamacaes/rua-da-torre,0.7,2).
aresta(lamacaes/rua-da-torre,lamacaes/rua-do-passal,0.17,1).
aresta(lamacaes/rua-do-passal,nogueiro/rua-da-rasa,1.6,4).

%sentido inverso 
aresta(palmeira/rua-da-poca,palmeira/rua-do-rio,3.4,6).
aresta(palmeira/rua-do-monte,palmeira/rua-do-rio,3.1,5).
aresta(palmeira/rua-da-poca,palmeira/rua-do-monte,2.4,4).
aresta(real/rua-dos-paiois,palmeira/rua-do-rio,8.5,12).
aresta(maximinos/rua-de-caires,palmeira/rua-da-poca,6.5,9).
aresta(maximinos/rua-da-naia,palmeira/rua-do-monte,7,10).
aresta(maximinos/rua-de-caires,maximinos/rua-da-naia,2.2,5).
aresta(maximinos/rua-do-cruzeiro,maximinos/rua-da-naia,0.65,2).
aresta(maximinos/rua-de-caires,maximinos/rua-do-cruzeiro,2,4).
aresta(real/rua-do-tojal,maximinos/rua-do-cruzeiro,1.8,4).
aresta(real/rua-dos-paiois,real/rua-do-tojal,0.4,2).
aresta(real/rua-das-giestas,real/rua-do-tojal,0.3,2).
aresta(real/rua-das-giestas,real/rua-dos-paiois,0.35,1).
aresta(sao-vitor/rua-da-fabrica,sao-vitor/rua-do-taxa,1.2,4).
aresta(sao-vitor/rua-dom-pedro-v,sao-vitor/rua-da-fabrica,0.8,2).
aresta(sao-vitor/rua-dom-pedro-v,sao-vitor/rua-do-taxa,1.6,3).
aresta(nogueiro/rua-da-capela,sao-vitor/rua-da-fabrica,3.1,6).
aresta(gualtar/rua-do-fontelo,sao-vitor/rua-dom-pedro-v,2.7,5).
aresta(lamacaes/rua-da-torre,sao-vitor/rua-do-taxa,3.9,8).
aresta(gualtar/rua-do-fontao,gualtar/rua-do-fontelo,2.3,5).
aresta(gualtar/green-distribution,gualtar/rua-do-fontao,2.9,6).
aresta(gualtar/rua-breias,gualtar/green-distribution,2.4,5).
aresta(nogueiro/rua-do-major,gualtar/rua-breias,5,9).
aresta(nogueiro/rua-da-rasa,nogueiro/rua-do-major,0.4,2).
aresta(nogueiro/rua-da-capela,nogueiro/rua-da-rasa,0.75,3).
aresta(nogueiro/rua-do-major,nogueiro/rua-da-capela,0.65,2).
aresta(lamacaes/rua-da-carreira,gualtar/rua-do-fontao,4.9,9).
aresta(lamacaes/rua-da-torre,lamacaes/rua-da-carreira,0.7,2).
aresta(lamacaes/rua-do-passal,lamacaes/rua-da-torre,0.17,1).
aresta(nogueiro/rua-da-rasa,lamacaes/rua-do-passal,1.6,4).
aresta(real/rua-das-giestas,sao-vitor/rua-do-taxa,6.3,9).


estima(gualtar/green-distribution,0,0).
estima(gualtar/rua-breias,2,4.5).
estima(gualtar/rua-do-fontao,2.9,5.8).
estima(gualtar/rua-do-fontelo,5.2,12).
estima(lamacaes/rua-da-carreira,7.8,16.7).
estima(lamacaes/rua-da-torre,8.5,16.4).
estima(lamacaes/rua-do-passal,8.7,17.5).
estima(nogueiro/rua-do-major,7.4,13).
estima(nogueiro/rua-da-capela,8.1,15).
estima(nogueiro/rua-do-rasa,7.8,16).
estima(sao-vitor/rua-dom-pedro-v,7.9,14.8).
estima(sao-vitor/rua-da-fabrica,6.6,18).
estima(sao-vitor/rua-do-taxa,9.5,20).
estima(real/rua-das-giestas,15.8,25).
estima(real/rua-dos-paiois,16.1,29).
estima(real/rua-do-tojal,16.1,28). 
estima(palmeira/rua-do-rio,24.7,40).
estima(palmeira/rua-da-poca,28.1,47).
estima(palmeira/rua-do-monte,27.8,43).
estima(maximinos/rua-do-cruzeiro,17.9,32).
estima(maximinos/rua-de-caires,19.9,35).
estima(maximinos/rua-da-naia,18.6,30).
estima(gualtar/green-distribution,0,0).



%circuito


circuito(encomenda(palmeira/rua-do-rio, lataDaMonster, yoda, data(2021, 01, 05), hora(15,40), 10/2, 50), [real/rua-dos-paiois, real/rua-das-giestas, sao-vitor/rua-do-taxa, sao-vitor/rua-dom-pedro-v, gualtar/rua-do-fontelo, gualtar/rua-do-fontao, gualtar/green-distribution]).
circuito(encomenda(palmeira/rua-do-rio, lataDaMonster, yoda, data(2021, 01, 05), hora(15,40), 10/2, 50), [nogueiro/rua-da-capela, nogueiro/rua-do-major, gualtar/rua-breias, gualtar/green-distribution]).
circuito(encomenda(palmeira/rua-do-rio, lataDaMonster, yoda, data(2021, 01, 05), hora(15,40), 10/2, 50), [nogueiro/rua-da-capela, nogueiro/rua-do-major, gualtar/rua-breias, gualtar/green-distribution]).
circuito(encomenda(palmeira/rua-do-rio, lataDaMonster, yoda, data(2021, 01, 05), hora(15,40), 10/2, 50), [nogueiro/rua-da-capela, nogueiro/rua-do-major, gualtar/rua-breias, gualtar/green-distribution]).
circuito(encomenda(palmeira/rua-do-rio, lataDaMonster, yoda, data(2021, 01, 05), hora(15,40), 10/2, 50), [nogueiro/rua-da-capela, nogueiro/rua-do-major, gualtar/rua-breias, gualtar/green-distribution]).
circuito(encomenda(palmeira/rua-do-rio, lataDaMonster, yoda, data(2021, 01, 05), hora(15,40), 10/2, 50), [nogueiro/rua-da-capela, nogueiro/rua-do-major, gualtar/rua-breias, gualtar/green-distribution]).


%encomenda


% transporte(destino, idEntrega, idCliente, dataMax, peso/volume, preco).

encomenda(palmeira/rua-do-rio, lataDaMonster, manuel, data(2021, 01, 05), hora(15,40), 10/2, 50).   %deixei a hora em separado pq na entrega as datas estao como um tuplo


% entrega(identrega, idEstafeta, idCliente, freguesia/rua , dataMax/dataEntrega , classificação, peso/volume, preço)


:- op( 900,xfy,'::' ).


+entrega(Id, _, _, _, _, _, _, _) :: ((findall(Id,(entrega(Id, _, _, _, _, _, _, _)),Sol), length(Sol,N), N < 2)).


entrega(televisao, joaquim, manuel, vila-caiz/aldeia-nova, data(2021, 1, 30)/data(2021, 1, 29),5, 30/80, 10).
entrega(portatil, rui, bernardo, roriz/pidre, data(2021, 2, 12)/data(2021, 2, 11),4 , 12/30, 5).
entrega(telemovel, ze-joao, miguel, barcelos/pedreira, data(2021, 3, 10)/data(2021, 1, 29), 3, 3/10, 3).

entrega(forno, painatal, bernardo, roriz/pidre, data(2021, 2, 12)/data(2021, 3, 29), 1, 12/30, 5).
entrega(telemovel, margarida, pedro, vila-caiz/aldeia-nova, data(2021, 3, 10)/data(2021, 3, 9), 2, 3/10, 3).
entrega(teclado, rui, alberto, esposende/margem, data(2021, 6, 19)/data(2021, 5, 22), 5, 21/30, 4).
entrega(rato, miguel, joao, esposende/margem, data(2021, 6, 22)/data(2021, 6, 22), 5, 2/30, 50).
entrega(headset, margarida, ana, esposende/margem, data(2021, 12, 30)/data(2021, 12, 29), 3, 9/30, 24).

entrega(pao, gigachad, ana, braga/vila-verde,data(2021, 3, 10)/data(2021, 1, 29), 3, 3/10, 3).
entrega(pizza, gigachad, bernardo, braga/vila-verde,data(2021, 3, 11)/data(2021, 1, 30), 3, 3/10, 3).
entrega(hamburger, gigachad, antonio, braga/real, data(2021, 3, 30)/data(2021,3,15), 5 , 4/11 , 5).




% estafeta(idEstafeta, freguesia, veiculo)
estafeta(bobbaFett, palmeira, carro).
estafeta(yoda, palmeira, mota).
estafeta(stormtrooper, palmeira, bicicleta).

estafeta(jangoFett, maximinos, carro).
estafeta(dathVader, maximinos, mota).
estafeta(luke, maximinos, bicicleta).

estafeta(r2d2, real, carro).
estafeta(rui, real, mota).
estafeta(leia, real, bicicleta).

estafeta(anakin, sao-vitor, carro).
estafeta(chewbacca, sao-vitor, mota).
estafeta(ze-joao, sao-vitor, bicicleta).

estafeta(c3po, gualtar, carro).
estafeta(bb8, gualtar, mota).
estafeta(miguel, gualtar, bicicleta).

estafeta(hanSolo, nogueiro, carro).
estafeta(margarida, nogueiro, mota).
estafeta(mandalorian, nogueiro, bicicleta).

estafeta(maceWindu, lamacaes, carro).
estafeta(darthMaul, lamacaes, mota).
estafeta(gigachad, lamacaes, bicicleta).



% veiculo (tipo de veiculo, velocidade_media, cargaMax, vertente_ecologica)
veiculo(bicicleta, 10, 5, 50).
veiculo(mota, 35, 20, 30).
veiculo(carro, 25, 100, 10). 



decrescimo_bicicleta(VelocidadeMedia, Kgs, NovaVelocidadeMedia) :-
    Decrescimo is 0.7 * Kgs,
    NovaVelocidadeMedia is VelocidadeMedia - Decrescimo.

decrescimo_motos(VelocidadeMedia, Kgs, NovaVelocidadeMedia) :-
    Decrescimo is 0.5 * Kgs,
    NovaVelocidadeMedia is VelocidadeMedia - Decrescimo.

decrescimo_carro(VelocidadeMedia, Kgs, NovaVelocidadeMedia) :-
    Decrescimo is 0.7 * Kgs,
    NovaVelocidadeMedia is VelocidadeMedia - Decrescimo.



calcularTempo(Distancia, Veiculo, Peso, Tempo) :-    %o Decrescimo vem do predicado decrescimo_motos / bicicleta / carro
    Veiculo == carro -> decrescimo_carro(25, Peso, NovaVelocidadeMedia),
                        Tempo is Distancia/NovaVelocidadeMedia;
    Veiculo == mota -> decrescimo_motos(35, Peso, NovaVelocidadeMedia),
                        Tempo is Distancia/NovaVelocidadeMedia;
    Veiculo == bicicleta -> decrescimo_bicicleta(10, Peso, NovaVelocidadeMedia),
                        Tempo is Distancia/NovaVelocidadeMedia;
    !, fail.
